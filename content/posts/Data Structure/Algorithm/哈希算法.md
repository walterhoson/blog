---
title: 哈希算法
description: 将任意长度的二进制值串映射为固定长度的二进制值串，该映射的规则就是**哈希算法**。而映射后得到的二进制值串就是**哈希值**。比较著名的有 MD5、SHA 等。
toc: true
authors: 
    - WayneShen
tags: 
    - Data Structure
    - Notes
categories: 
    - Data Structure
series: []
date: '2021-06-02T02:05:+08:00'
lastmod: '2021-06-02T02:10:08+08:00'
featuredImage: ''
draft: false
---

</br>

将任意长度的二进制值串映射为固定长度的二进制值串，该映射的规则就是**哈希算法**。而映射后得到的二进制值串就是**哈希值**。比较著名的有 MD5、SHA 等。

<!--more-->

## 哈希算法要求

+ 从哈希值不能反向推导出原始数据
  
+ 对输入数据敏感，哪怕只修改原始数据一个 bit，哈希值也大不相同
  
+ 散列冲突概率要很小
  
+ 执行效率要尽量高效，较长的文本，也能快速计算出哈希值

## 应用场景

### 安全加密

常用的加密的哈希算法有 MD5（Message-Digest Algorithm,MD5 消息摘要算法）和 SHA （Secure Hash Algorithm, 安全散列算法）。

MD5 计算出的哈希值是固定的 128 位二进制，能表示的数据是有限的，最多能表示 2<sup>128</sup> 个数据，所以必然会存在哈希值相同的情况。

一般情况下，哈希值越长的哈希算法，散列冲突的概率越低。

### 唯一标识

针对文件取一个信息摘要（比如文件二进制码串开头 100 字节，中间 100 字节，尾部 100 字节，通过哈希算法获得哈希值）实现验重，可以减少很多工作量。

哈希值不一样一定不重复，一样可能重复。

### 数据校验

通过哈希算法，对 100 个文件块分别取哈希值，并且保存在种子文件中。

哈希算法对数据很敏感。只要文件块的内容有一丁点的改变，最后计算出的哈希值就会完全不同。

所以，当文件块下载完成之后，就可以通过相同的哈希算法，对下载好的文件块逐一求哈希值，然后跟种子文件中保存的哈希值比对。如果不同，说明这个文件块不完整或被篡改了。

### 散列函数

散列函数决定了散列冲突的概率和散列表性能。此时不关心是否能反向解密，更关注值的平均分布。

### 负载均衡

负载均衡算法有轮训、随机、加权轮训等，但若要实现会话粘滞（session sticky）的负载均衡算法，就可以使用哈希算法。

利用哈希算法，对客户端 IP 地址或会话 ID 计算哈希值，将取得的哈希值与服务器列表的大小进行取模运算，最终得到的值就是应该被路由到的服务器编号。

这样就可以把同一个 IP 过来的所有请求都路由到同一个后端服务器上。

### 数据分片

处理大量数据时，可以先对数据进行分片，然后采用多台机器处理的方法，来提高处理速度。

比如一个大文件中搜索多个关键词，可以将关键词计算哈希值，然后和机器数量取模，分配到不同的机器上。这样相同哈希值的关键词就会被分配到同一台机器上。

### 分布式存储

一致性哈希算法，假设有 k 个机器，数据的哈希值的范围是 [0, MAX]。我们将整个范围划分成 m 个小区间 (m 远大于 k) ，每个机器负责 m/k 个小区间。

当有新机器加入时，就将某几个小区间的数据，从原来的机器中搬移到新的机器中。这样既不用全部重新哈希、搬移数据，也保持了各个机器上数据数量的均衡。

## 参考资料

《数据结构与算法之美》
